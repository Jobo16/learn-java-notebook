---
title: 异常-finally必要性
category: 02-控制流与异常
topic: 20-异常处理
created: 2026-02-02
reviewed: 2026-02-02
tags: [java, 控制流与异常]
status: active
---

涓嶅浣欍€俙finally`瑙ｅ喅鐨勬牳蹇冪偣鏄€滄帶鍒舵祦鍙兘鏍规湰璧颁笉鍒?try catch 涔嬪悗鈥濓紝鎵€浠ユ妸娓呯悊浠ｇ爜鏀惧湪澶栭潰骞朵笉鑳芥彁渚涘悓绛変繚璇併€?
## 涓轰粈涔堟斁鍦ㄥ闈笉绛変环

鎶娾€滄€昏鎵ц鐨勪唬鐮佲€濇斁鍒?`try/catch` 鍚庨潰锛屽彧鏈夊湪涓嬮潰鏉′欢閮芥弧瓒虫椂鎵嶅彲闈狅細

1. `try` 鍜?`catch` 閲岄兘娌℃湁 `return`
    
2. `try` 鍜?`catch` 閲岄兘娌℃湁 `throw` 缁х画鍚戝鎶?    
3. 娌℃湁 `break` 鎴?`continue` 鎻愬墠璺冲嚭寰幆
    
4. 娌℃湁寮傚父閫冮€稿嚭 `try/catch` 缁撴瀯  
    鍙鍑虹幇浠讳綍涓€绉嶆彁鍓嶇寮€褰撳墠浠ｇ爜鍧楃殑璺緞锛屽闈㈢殑浠ｇ爜灏卞彲鑳芥墽琛屼笉鍒般€?    

`finally`鎻愪緵鐨勬槸璇█绾т繚璇侊細鏃犺 `try` 姝ｅ父缁撴潫銆佹姏寮傚父銆佽 `catch` 澶勭悊銆乣catch` 鍐嶆鎶涘嚭銆侀亣鍒?`return`銆乣break`銆乣continue`锛宍finally`閮戒細鍦ㄧ寮€璇ョ粨鏋勫墠鎵ц娓呯悊閫昏緫銆?
## 鍏稿瀷鍦烘櫙

### 1) try 閲?return

`function f() {   try {     return 42;   } finally {     console.log("cleanup");   } } f(); // 涓€瀹氫細鎵撳嵃 cleanup`

濡傛灉鎶?`console.log` 鏀惧湪 `try/catch` 澶栭潰锛宍return` 宸茬粡缁撴潫鍑芥暟锛屽闈㈢殑浠ｇ爜鏍规湰娌℃満浼氭墽琛屻€?
### 2) 寮傚父缁х画鍚戝鎶?
`void g() {   try {     risky();              // 鎶涘紓甯?  } finally {     cleanup();            // 涓€瀹氭墽琛?  }   // 杩欓噷鍙兘姘歌繙璧颁笉鍒帮紝鍥犱负寮傚父浼氱户缁姏鍑?}`

娓呯悊閫昏緫鏀惧湪 `try/catch` 鍚庨潰锛岄亣鍒版湭鎹曡幏鎴栭噸鏂版姏鍑虹殑寮傚父鏃跺氨浼氳璺宠繃銆?
### 3) 閲婃斁閿佸拰鎭㈠鐘舵€?
`lock.lock(); try {   // 涓寸晫鍖?} finally {   lock.unlock();          // 蹇呴』淇濊瘉鎵ц }`

鎶?`unlock` 鏀惧闈紝涓€鏃︿复鐣屽尯鎶涘紓甯告垨鎻愬墠杩斿洖锛岄攣灏卞彲鑳芥案杩滀笉閲婃斁銆?
### 4) 寰幆閲岀殑 break 鍜?continue

`for (const x of xs) {   try {     if (x === 0) break;   } finally {     console.log("per-iteration cleanup");   } }`

澶栫疆娓呯悊鍦?`break` 璺冲嚭鏃跺緢瀹规槗婕忔帀姣忔杩唬闇€瑕佸仛鐨勬敹灏俱€?
## 浠€涔堟椂鍊欑‘瀹炲彲浠ヤ笉鐢?finally

- `try` 鍐呴儴娌℃湁浠讳綍鎻愬墠閫€鍑鸿矾寰勶紝涔熶繚璇佹墍鏈夊紓甯搁兘鍦ㄥ綋鍓嶅眰琚鐞嗗畬锛屽苟涓斿悗缁唬鐮佸繀鐒舵墽琛屽緱鍒?    
- 浣跨敤璇█鏇存帹鑽愮殑璧勬簮绠＄悊缁撴瀯
    
    - Java 鐨?try with resources
        
    - C# 鐨?`using`
        
    - Python 鐨?`with`
        
    - Go 鐨?`defer`
        
    - C++ 鐨?RAII  
        杩欎簺缁撴瀯鏈川涓婁篃鏄湪鎻愪緵鈥滅寮€浣滅敤鍩熸椂鑷姩娓呯悊鈥濈殑璇箟銆?        

## 闇€瑕佺煡閬撶殑杈圭晫

`finally`涔熶笉鏄粷瀵逛繚璇侊紝杩涚▼琚己鍒剁粓姝€佸穿婧冦€佹柇鐢佃繖绫绘儏鍐垫棤娉曢潬璇█缁撴瀯鍏滃簳銆傚畠淇濊瘉鐨勬槸鍦ㄦ甯哥殑璇█杩愯鎺у埗娴侀噷绂诲紑 `try` 缁撴瀯涔嬪墠浼氭墽琛屻€?
濡傛灉浣犵粰鎴戜竴涓綘姝ｅ湪鍐欑殑鍏蜂綋鐗囨锛屾垜鍙互鐩存帴鍒ゆ柇鏀惧闈㈡槸鍚﹀畨鍏紝浠ュ強鏈夋病鏈夋洿绠€娲佺殑鍐欐硶銆
