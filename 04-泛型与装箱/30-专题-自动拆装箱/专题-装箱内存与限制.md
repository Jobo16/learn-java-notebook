---
title: 专题-装箱内存与限制
category: 04-泛型与装箱
topic: 30-专题-自动拆装箱
created: 2026-01-26
reviewed: 2026-02-02
tags: [java, 泛型与装箱]
status: active
---

### 涓€銆?鍏堥摵鍨袱涓墠缃熀纭€姒傚康

鍦ㄨ瑙ｆ牳蹇冮棶棰樺墠锛屽厛鏄庣‘涓や釜鍏抽敭姒傚康锛岄伩鍏嶅悗缁悊瑙ｅ崱椤匡細

1. **鍩烘湰绫诲瀷锛圥rimitive Type锛?*锛欽ava 涓殑 8 绉嶅熀鏈暟鎹被鍨嬶紝`byte銆乻hort銆乮nt銆乴ong銆乫loat銆乨ouble銆乧har銆乥oolean`銆?    
    - 鐗圭偣锛?*涓嶇户鎵胯嚜 Object**锛岀洿鎺ュ瓨鍌?*鏁版嵁鍊?*锛屽崰鐢ㄥ浐瀹氬唴瀛樼┖闂达紙濡?int 鍗?4 瀛楄妭锛夛紝瀛樺偍鍦?*鏍堝唴瀛?*锛堝眬閮ㄥ彉閲忥級鎴?*鍫嗗唴瀛樼殑瀵硅薄瀹炰緥涓?*锛堝疄渚嬪彉閲忥級锛屾棤棰濆鍐呭瓨寮€閿€銆?    
2. **鍖呰绫诲瀷锛圵rapper Class锛?*锛氬搴?8 绉嶅熀鏈被鍨嬬殑寮曠敤绫诲瀷锛宍Byte銆丼hort銆両nteger銆丩ong銆丗loat銆丏ouble銆丆haracter銆丅oolean`銆?    
    - 鐗圭偣锛?*缁ф壙鑷?Object**锛屾槸涓€涓?*瀵硅薄**锛屽瓨鍌ㄥ湪**鍫嗗唴瀛?*涓紝鏍堜腑浠呭瓨鍌ㄦ寚鍚戝爢涓璞＄殑寮曠敤锛堥€氬父 4/8 瀛楄妭锛屽彇鍐充簬 JVM 浣嶆暟锛夛紝瀵硅薄鍐呴儴鍖呭惈涓€涓搴旂殑鍩烘湰绫诲瀷鍊硷紝杩樻湁瀵硅薄澶达紙Mark Word銆佺被鍏冧俊鎭寚閽堢瓑锛夛紝瀛樺湪棰濆鍐呭瓨寮€閿€銆?    

---

### 浜屻€?鑷姩鎷嗚绠憋紙Autoboxing/Unboxing锛夌殑鍐呭瓨寮€閿€

鑷姩鎷嗚绠辨槸 Java 5 寮曞叆鐨勮娉曠硸锛岀洰鐨勬槸绠€鍖栧熀鏈被鍨嬪拰鍖呰绫诲瀷涔嬮棿鐨勬墜鍔ㄨ浆鎹紝**鏈川鏄紪璇戝櫒鍦ㄧ紪璇戦樁娈佃嚜鍔ㄦ彃鍏ヨ浆鎹㈡柟娉曪紝杩愯鏃朵粛浼氭墽琛岀湡瀹炵殑瀵硅薄鍒涘缓 / 鍊兼彁鍙栨搷浣?*銆?
#### 1. 浠€涔堟槸鑷姩鎷嗚绠憋紵

- **鑷姩瑁呯锛圓utoboxing锛?*锛氬熀鏈被鍨?鈫?鍖呰绫诲瀷锛堢紪璇戝櫒鑷姩璋冪敤`valueOf()`鏂规硶锛?    
    绀轰緥锛歚Integer a = 10;`锛堢瓑浠蜂簬`Integer a = Integer.valueOf(10);`锛?- **鑷姩鎷嗙锛圲nboxing锛?*锛氬寘瑁呯被鍨?鈫?鍩烘湰绫诲瀷锛堢紪璇戝櫒鑷姩璋冪敤`xxxValue()`鏂规硶锛屽`intValue()`锛?    
    绀轰緥锛歚int b = a;`锛堢瓑浠蜂簬`int b = a.intValue();`锛?
#### 2. 鏍稿績鍐呭瓨寮€閿€鏉ユ簮

鑷姩鎷嗚绠辩殑鍐呭瓨寮€閿€锛屾湰璐ㄦ槸**鍖呰绫诲瀷瀵硅薄甯︽潵鐨勯澶栧唴瀛樻秷鑰?*锛屼互鍙婇绻佸垱寤哄璞″彲鑳藉紩鍙戠殑 GC 鍘嬪姏锛屼富瑕佸垎涓轰袱鐐癸細

##### 锛?锛?鍖呰绫诲瀷瀵硅薄鐨勮嚜韬唴瀛樺紑閿€锛堟牳蹇冿級

鍩烘湰绫诲瀷浠呭瓨鍌ㄦ暟鎹€硷紝鑰屽寘瑁呯被鍨嬩綔涓哄璞★紝鍖呭惈涓夐儴鍒嗗唴瀛橈紙浠?32 浣?JVM 鐨刞Integer`涓轰緥锛夛細

1. **瀵硅薄澶达紙Object Header锛?*锛氱害 8 瀛楄妭锛圡ark Word锛? 瀛楄妭 + 绫诲厓淇℃伅鎸囬拡锛? 瀛楄妭锛夛紱
2. **瀹炰緥鏁版嵁锛圛nstance Data锛?*锛氬瓨鍌ㄥ搴旂殑鍩烘湰绫诲瀷鍊硷紝`int`鍗?4 瀛楄妭锛?3. **瀵归綈濉厖锛圥adding锛?*锛欽VM 瑕佹眰瀵硅薄鍐呭瓨澶у皬涓?8 瀛楄妭鐨勬暣鏁板€嶏紝姝ゅ 8+4=12 瀛楄妭锛岄渶濉厖 4 瀛楄妭锛屾渶缁坄Integer`瀵硅薄鍏卞崰**16 瀛楄妭**銆?
瀵规瘮锛氬熀鏈被鍨媊int`浠呭崰**4 瀛楄妭**锛屽寘瑁呯被鍨媊Integer`鐨勫唴瀛樺紑閿€鏄熀鏈被鍨嬬殑 4 鍊嶃€?
鍏朵粬鍖呰绫诲瀷绫讳技锛堝`Long`瀵硅薄绾?24 瀛楄妭锛岃€屽熀鏈被鍨媊long`浠?8 瀛楄妭锛夛紝閮藉瓨鍦ㄨ繙瓒呭熀鏈被鍨嬬殑棰濆鍐呭瓨娑堣€椼€?
##### 锛?锛?棰戠箒瑁呯瀵艰嚧鐨勪复鏃跺璞″垱寤轰笌 GC 鍘嬪姏

濡傛灉鍦ㄥ惊鐜瓑楂橀鍦烘櫙涓娇鐢ㄨ嚜鍔ㄨ绠憋紝浼氶绻佸垱寤哄寘瑁呯被鍨嬪璞★紙鍗充娇鏈夊父閲忔睜缂撳瓨锛屼篃浠呯紦瀛橀儴鍒嗗€硷紝濡俙Integer`缂撳瓨`[-128, 127]`锛夛紝绀轰緥锛?
java

杩愯

```
// 楂橀瑁呯鍦烘櫙锛屽瓨鍦ㄥぇ閲忎复鏃禝nteger瀵硅薄鍒涘缓
Integer sum = 0;
for (int i = 1; i <= 10000; i++) {
    sum += i; // 绛変环浜?sum = Integer.valueOf(sum.intValue() + i);
}
```

涓婅堪浠ｇ爜涓紝`sum += i`浼氬弽澶嶆墽琛?鈥滄媶绠扁啋璁＄畻鈫掕绠扁€濓紝鍒涘缓澶ч噺`Integer`涓存椂瀵硅薄锛岃繖浜涘璞′娇鐢ㄥ悗浼氭垚涓哄瀮鍦撅紝澧炲姞 JVM 鐨勫瀮鍦惧洖鏀讹紙GC锛夊帇鍔涳紝闂存帴褰卞搷绋嬪簭鎬ц兘锛屽悓鏃朵复鏃跺璞″湪鍫嗕腑鍗犵敤鐨勫唴瀛橈紝涔熸槸棰濆鐨勫唴瀛樺紑閿€銆?
#### 3. 琛ュ厖锛氱紦瀛樺寮€閿€鐨勭紦瑙ｏ紙涓嶆敼鍙樻湰璐級

鍍廯Integer銆丅yte`绛夊寘瑁呯被鍨嬶紝鎻愪緵浜嗗父閲忔睜缂撳瓨锛堝`Integer.valueOf()`浼氱紦瀛榒[-128, 127]`鐨勫璞★級锛岃繖鑳藉噺灏戦儴鍒嗗璞″垱寤猴紝缂撹В鍐呭瓨寮€閿€锛屼絾**鏃犳硶鏀瑰彉鍖呰绫诲瀷鏈韩姣斿熀鏈被鍨嬪唴瀛樻秷鑰楀ぇ鐨勬湰璐?*锛屼笖瓒呭嚭缂撳瓨鑼冨洿鐨勫€硷紝浠嶄細鍒涘缓鏂板璞★紝甯︽潵瀹屾暣寮€閿€銆?
---

### 涓夈€?娉涘瀷涓嶆敮鎸佸熀鏈被鍨嬬殑鏈川

Java 鐨勬硾鍨嬶紙Generic锛変笉鏀寔鍩烘湰绫诲瀷锛堝涓嶈兘鍐檂List<int>`锛屽彧鑳藉啓`List<Integer>`锛夛紝鏍稿績鍘熷洜鏈変袱涓紝**搴曞眰璁捐鍏煎锛堢被鍨嬫摝闄わ級鏄牴鏈紝鍖呰绫诲瀷缁熶竴浣撶郴鏄ˉ鍏?*锛?
#### 1. 鏍规湰鍘熷洜锛欽ava 娉涘瀷鐨勫疄鐜版満鍒?鈥斺€?绫诲瀷鎿﹂櫎锛圱ype Erasure锛?
Java 鐨勬硾鍨嬫槸**缂栬瘧鏈熸硾鍨?*锛屼粎鍦ㄧ紪璇戦樁娈垫彁渚涚被鍨嬫鏌ワ紝杩愯鏃朵細鎵ц**绫诲瀷鎿﹂櫎**锛氱紪璇戝櫒浼氬皢鎵€鏈夋硾鍨嬪弬鏁版摝闄や负鍏?*涓婇檺绫诲瀷锛堥粯璁ゆ槸 Object锛?*锛屾硾鍨嬩俊鎭湪杩愯鏃朵笉瀛樺湪銆?
涓句釜渚嬪瓙锛?
缂栬瘧鏃剁殑浠ｇ爜`List<Integer> list = new ArrayList<>();`锛岃繍琛屾椂浼氳鎿﹂櫎涓篳List list = new ArrayList();`锛屾墍鏈夊`Integer`鐨勭被鍨嬬害鏉燂紝浠呭湪缂栬瘧闃舵鐢熸晥锛岃繍琛屾椂 JVM 鏃犳硶鍖哄垎`List<Integer>`鍜宍List<String>`銆?
姝ｆ槸鍥犱负绫诲瀷鎿﹂櫎鍚庯紝娉涘瀷鍙傛暟浼氳鏇挎崲涓篳Object`锛堟垨鍏朵粬涓婇檺寮曠敤绫诲瀷锛夛紝鑰?*鍩烘湰绫诲瀷涓嶇户鎵胯嚜 Object锛屾棤娉曡 Object 绫诲瀷瀹圭撼**锛屾墍浠ユ硾鍨嬫棤娉曟敮鎸佸熀鏈被鍨嬨€?
绠€鍗曟⒊鐞嗛€昏緫閾撅細

娉涘瀷杩愯鏃舵摝闄?鈫?娉涘瀷鍙傛暟琚浛鎹负 Object锛堝紩鐢ㄧ被鍨嬶級 鈫?鍩烘湰绫诲瀷涓嶆槸 Object 鐨勫瓙绫伙紝鏃犳硶閫傞厤 鈫?娉涘瀷涓嶆敮鎸佸熀鏈被鍨嬨€?
濡傛灉 Java 鏀寔`List<int>`锛岀被鍨嬫摝闄ゅ悗浼氬彉鎴恅List<Object>`锛屼絾`int`鏃犳硶杞崲涓篳Object`锛屼細瀵艰嚧杩愯鏃剁被鍨嬫贩涔憋紝杩欐槸 Java 娉涘瀷璁捐涔嬪垵涓轰簡鍏煎鏃х増鏈唬鐮侊紙鏃犳硾鍨嬬殑 JDK 1.4 鍙婁互鍓嶏級鑰屽仛鍑虹殑濡ュ崗锛屼篃鐩存帴瀵艰嚧浜嗘硾鍨嬩笉鏀寔鍩烘湰绫诲瀷銆?
#### 2. 琛ュ厖鍘熷洜锛欽ava 闆嗗悎妗嗘灦鐨勮璁′緷璧栧紩鐢ㄧ被鍨?
娉涘瀷鏈€甯哥敤鐨勫満鏅槸闆嗗悎妗嗘灦锛坄List銆丮ap銆丼et`绛夛級锛岃€?Java 闆嗗悎妗嗘灦鐨勬牳蹇冩槸**瀛樺偍瀵硅薄锛堝紩鐢ㄧ被鍨嬶級**锛岄泦鍚堜腑鐨刞add()銆乬et()`绛夋柟娉曠殑鍙傛暟 / 杩斿洖鍊奸兘鏄痐Object`绫诲瀷锛屾棤娉曟帴鏀跺熀鏈被鍨嬨€?
娉涘瀷浣滀负闆嗗悎妗嗘灦鐨勮ˉ鍏咃紝鑷劧寤剁画浜?鈥滀粎鏀寔寮曠敤绫诲瀷鈥?鐨勮璁★紝鑰屽熀鏈被鍨嬭瀛樺叆闆嗗悎锛屽繀椤诲厛瑁呯涓哄寘瑁呯被鍨嬶紙寮曠敤绫诲瀷锛夛紝杩欎篃鍜岃嚜鍔ㄦ媶瑁呯鐨勮璁″舰鎴愪簡鍛煎簲銆?
#### 3. 瀵规瘮锛氬叾浠栬瑷€鐨勬硾鍨嬶紙涓轰粈涔堟湁鐨勮瑷€鏀寔锛燂級

鍍?C#銆丆++ 鐨勬硾鍨嬫槸**杩愯鏃舵硾鍨?*锛屼笉浼氳繘琛岀被鍨嬫摝闄わ紝缂栬瘧鍣ㄤ細涓烘瘡涓硾鍨嬪弬鏁扮被鍨嬬敓鎴愮嫭绔嬬殑瀛楄妭鐮侊紝鍥犳鍙互鐩存帴鏀寔鍩烘湰绫诲瀷锛堝 C# 鐨刞List<int>`锛夛紝鑰?Java 鐨勭被鍨嬫摝闄よ璁★紝铏界劧淇濊瘉浜嗗悜涓嬪吋瀹癸紝浣嗕篃鐗虹壊浜嗘硾鍨嬪鍩烘湰绫诲瀷鐨勬敮鎸併€?
---

### 鍥涖€?寤朵几锛氬浣曠紦瑙ｈ繖浜涢棶棰橈紵

1. 瀵逛簬鑷姩鎷嗚绠辩殑鍐呭瓨寮€閿€锛氶珮棰戣绠椼€佸ぇ鏁版嵁閲忓満鏅紭鍏堜娇鐢?*鍩烘湰绫诲瀷**锛岄伩鍏嶄笉蹇呰鐨勮嚜鍔ㄨ绠憋紱
2. 瀵逛簬娉涘瀷涓嶆敮鎸佸熀鏈被鍨嬬殑闂锛氬彲浠ヤ娇鐢ㄧ涓夋柟妗嗘灦锛屽**Google Guava**锛堟彁渚沗Ints.asList()`锛夈€?*Eclipse Collections**锛屾垨 Java 8 + 鐨?*Stream API**锛屼篃鍙互浣跨敤**Netty FastThreadLocal**绛夊伐鍏凤紝鍑忓皯鍖呰绫诲瀷鐨勪娇鐢紱
3. 澶ф暟鎹噺鍦烘櫙锛堝鏁扮粍銆侀泦鍚堝瓨鍌ㄥ崈涓囩骇鍩烘湰绫诲瀷鏁版嵁锛夛細浼樺厛浣跨敤**鍩烘湰绫诲瀷鏁扮粍**锛堝`int[]`锛夛紝鎴栫涓夋柟鍩烘湰绫诲瀷闆嗗悎锛堝`org.apache.commons.collections.primitives.IntList`锛夛紝閬垮厤鍖呰绫诲瀷鐨勫唴瀛樺紑閿€銆?
### 鎬荤粨

1. 鑷姩鎷嗚绠辩殑鍐呭瓨寮€閿€鏍稿績鏄?*鍖呰绫诲瀷瀵硅薄鐨勯澶栧唴瀛樻秷鑰?*锛堝璞″ご + 瀵归綈濉厖锛夛紝浠ュ強棰戠箒鍒涘缓瀵硅薄甯︽潵鐨?GC 鍘嬪姏锛屽寘瑁呯被鍨嬪唴瀛樿繙澶т簬瀵瑰簲鍩烘湰绫诲瀷銆?2. 娉涘瀷涓嶆敮鎸佸熀鏈被鍨嬬殑鏍规湰鍘熷洜鏄?*Java 鐨勭被鍨嬫摝闄ゆ満鍒?*锛堟硾鍨嬪弬鏁版摝闄ゅ悗涓?Object锛屽熀鏈被鍨嬩笉缁ф壙鑷?Object锛夛紝琛ュ厖鍘熷洜鏄泦鍚堟鏋朵粎鏀寔寮曠敤绫诲瀷銆?3. 涓よ€呭瓨鍦ㄥ叧鑱旓細娉涘瀷涓嶆敮鎸佸熀鏈被鍨嬶紝瀵艰嚧瀛樺偍鍩烘湰绫诲瀷鏁版嵁鏃跺繀椤讳娇鐢ㄥ寘瑁呯被鍨嬶紝杩涜€屽紩鍏ヨ嚜鍔ㄦ媶瑁呯鐨勫唴瀛樺紑閿€銆
